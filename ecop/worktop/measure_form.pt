<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE document SYSTEM "rml.dtd">
<document
  xmlns:doc="http://namespaces.zope.org/rml/doc"
  xmlns:py="http://genshi.edgewall.org/" title="台面测量单${variables['externalOrderId']}">

  <docinit displayDocTitle="true">
    <registerTTFont faceName="VeraBold" fileName="[reportlab]/fonts/VeraBd.ttf"/>
    <registerTTFont faceName="msyh" fileName="[ecop]/resources/msyh.ttf" />
    <registerTTFont faceName="msyhbd" fileName="[ecop]/resources/msyhbd.ttf" />
  </docinit>

  <template pagesize="a4" allowSplitting="1">
    <pageTemplate id="first">
      <pageGraphics>
        <setFont name="msyh" size="8" />
        <drawString x="1.8cm" y="23.5cm">测量草图</drawString>
        <rect x="1.5cm" y="1cm" width="18.5cm" height="23cm"/>
        <translate dx="1cm" dy="1cm"/>
        <rotate degrees="90" />
        <setFont name="Helvetica" size="6"/>
        <drawString x="0" y="0">© Inter IKEA Systems B.V. 2018</drawString>
      </pageGraphics>
      <frame id="header" x1="1.5cm" y1="23.5cm" width="18.5cm" height="5cm"/>
    </pageTemplate>
  </template>

  <stylesheet>
    <paraStyle name="normal" fontSize="12" leading="15" fontName="msyh" spaceBefore="3" spaceAfter="3" wordWrap="CJK" />
  </stylesheet>

  <story>
    <para fontSize="20" fontName="msyhbd">IKEA台面测量单</para>
    <spacer length="30" />
    <blockTable colWidths="60% 40%">
      <blockTableStyle id="dummy">
        <blockValign value="top" />
      </blockTableStyle>
      <tr>
        <td>
          <para style="normal" leftIndent="60" firstLineIndent="-60">
            顾客地址：${view.getRegionName(variables['customerRegionCode'])}${variables['customerStreet']}
          </para>
          <para style="normal">顾客姓名: ${variables['customerName']}</para>
          <para style="normal">联系电话：${variables['customerMobile']}</para>
        </td>
        <td>
          <para style="normal">订单编号：<font fontName="VeraBold" size="18">${variables['externalOrderId']}</font></para>
          <para style="normal">测量日期：${variables['confirmedMeasurementDate'].strftime('%Y/%m/%d')}</para>
        </td>
      </tr>
    </blockTable>
  </story>
</document>